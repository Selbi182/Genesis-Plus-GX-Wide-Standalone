STATIC = 1

include $(DEVKITPRO)/libnx/switch_rules
PKGCONFIG =	$(DEVKITPRO)/portlibs/switch/bin/aarch64-none-elf-pkg-config


CFLAGS +=	-DARM -march=armv8-a -mtune=cortex-a57 -mtp=soft -DLSB_FIRST \
			-DBYTE_ORDER=LITTLE_ENDIAN -DALIGN_LONG -DALIGN_WORD \
			-DM68K_OVERCLOCK_SHIFT=20 -DHAVE_ZLIB -DSWITCH -fPIE \
			-Wl,--allow-multiple-definition -specs=$(DEVKITPRO)/libnx/switch.specs
DEFINES +=	-DHAVE_ALLOCA_H
LIBS +=		-L$(LIBNX)/lib -lnx -lm
INCLUDES +=	-I$(LIBNX)/include -I$(PORTLIBS)/include/SDL2 -I$(PORTLIBS)/include

ifdef NXLINK
	DEFINES += -DENABLE_NXLINK
endif

SUFFIX =	.elf
PKGSUFFIX = .nro

$(PKGPATH): $(OUTDIR)/$(NAME)
	@echo -n "Building nro..."
	@elf2nro $< $@ $(NROFLAGS)
	@echo " Done!"